USE CSDLNC

CREATE INDEX IX_NVNGHIEPVU_LOAINV_NHANVIEN ON NVNGHIEPVU(LOAINV) WHERE LOAINV = 0
--DROP INDEX NVNGHIEPVU.IX_NVNGHIEPVU_LOAINV_NHANVIEN
CREATE INDEX IX_NVNGHIEPVU_LOAINV_QTV ON NVNGHIEPVU(LOAINV) WHERE LOAINV = 1
--DROP INDEX NVNGHIEPVU.IX_NVNGHIEPVU_LOAINV_QTV
CREATE INDEX IX_NVNGHIEPVU_GIOITINH ON NVNGHIEPVU(GIOITINH)
--DROP INDEX NVNGHIEPVU.IX_NVNGHIEPVU_LOAINV_GIOITINH
--CREATE INDEX IX_NVNGHIEPVU_NGAYSINH ON NVNGHIEPVU(NGAYSINH)
--DROP INDEX NVNGHIEPVU.IX_NVNGHIEPVU_LOAINV_NGAYSINH


CREATE INDEX IX_NHASI_MACN ON NHASI(MACN)
--DROP INDEX NHASI.IX_NHASI_MACN
CREATE INDEX IX_NHASI_GIOITINH ON NHASI(GIOITINH)
--DROP INDEX NHASI.IX_NHASI_GIOITINH
--CREATE INDEX IX_NHASI_NGAYSINH ON NHASI(NGAYSINH)
--DROP INDEX NHASI.IX_NHASI_NGAYSINH


-- TEST
-- TÌM NHÂN VIÊN
SELECT *
FROM NVNGHIEPVU WITH (INDEX(IX_NVNGHIEPVU_LOAINV_NHANVIEN))
WHERE LOAINV = 0

SELECT *
FROM NVNGHIEPVU
WHERE LOAINV = 0

-- TÌM QTV
SELECT *
FROM NVNGHIEPVU WITH (INDEX(IX_NVNGHIEPVU_LOAINV_QTV))
WHERE LOAINV = 1

SELECT *
FROM NVNGHIEPVU
WHERE LOAINV = 1

-- TÌM NV NAM
SELECT *
FROM NVNGHIEPVU WITH (INDEX(IX_NVNGHIEPVU_GIOITINH))
WHERE GIOITINH = 'Nam'

SELECT *
FROM NVNGHIEPVU
WHERE GIOITINH = 'Nam'

-- tìm theo ngày sinh
SELECT *
FROM NVNGHIEPVU WITH (INDEX(IX_NVNGHIEPVU_NGAYSINH))
WHERE MONTH(NGAYSINH) = 1

SELECT * 
FROM NVNGHIEPVU
WHERE MONTH(NGAYSINH) = 1

--bỏ ( cost lớn )

-- tìm ns theo cn 
SELECT *
FROM NHASI WITH (INDEX(IX_NHASI_MACN))
WHERE MACN = 1

SELECT *
FROM NHASI
WHERE MACN = 1